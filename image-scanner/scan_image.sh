#!/bin/bash
if  [[ -z "${URL_RESULT}" ]]; 
then
  echo "URL_RESULT not set, printing result"
  trivy client --remote http://image-vulnerability-db:8080 ${IMAGE_PATH}
else 
  trivy client -f json -o result.json --remote http://image-vulnerability-db:8080 ${IMAGE_PATH}
  if [ -s result.json ]
  then
    curl -v \
      -d @result.json \
      ${URL_RESULT}
  else
    echo "result.json is empty (no errors)"
  fi
fi
exit 0
