#!/bin/bash

#trivy client -f json -o result.json --remote http://vulnerability-db:8080 -q ${IMAGE_PATH}
if  [[ -z "${URL_RESULT}" ]]; 
then
  echo "URL_RESULT not set, printing result"
  trivy client --remote http://image-vulnerability-db:8080 ${IMAGE_PATH}
else 
  trivy client -f json -o result.json --remote http://image-vulnerability-db:8080 ${IMAGE_PATH}
  cat result.json
  curl \
    -X POST \
    -d @result.json \
    ${URL_RESULT}
fi
exit 0
