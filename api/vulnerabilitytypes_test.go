package main

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func Test_count_by_severity(t *testing.T) {
	target := Target{
		Vulnerabilities: []Vulnerability{
			{
				Severity: Critical,
			},
			{
				Severity: High,
			},
			{
				Severity: High,
			},
			{
				Severity: Unknown,
			},
		},
	}

	assert.Equal(t, 1, target.countBySeverity(Critical))
	assert.Equal(t, 2, target.countBySeverity(High))
	assert.Equal(t, 0, target.countBySeverity(Medium))
	assert.Equal(t, 0, target.countBySeverity(Low))
	assert.Equal(t, 1, target.countBySeverity(Unknown))

}
